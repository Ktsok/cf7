<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>InsertTeacherPage.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">schoolapp7-swing-soa-stage</a> &gt; <a href="index.source.html" class="el_package">gr.aueb.cf.schoolapp.view_controller</a> &gt; <span class="el_source">InsertTeacherPage.java</span></div><h1>InsertTeacherPage.java</h1><pre class="source lang-java linenums">package gr.aueb.cf.schoolapp.view_controller;

import gr.aueb.cf.schoolapp.Main;
import gr.aueb.cf.schoolapp.dao.CityDAOImpl;
import gr.aueb.cf.schoolapp.dao.ICityDAO;
import gr.aueb.cf.schoolapp.dao.ITeacherDAO;
import gr.aueb.cf.schoolapp.dao.TeacherDAOImpl;
import gr.aueb.cf.schoolapp.dao.exceptions.TeacherDAOException;
import gr.aueb.cf.schoolapp.dto.TeacherInsertDTO;
import gr.aueb.cf.schoolapp.dto.TeacherReadOnlyDTO;
import gr.aueb.cf.schoolapp.exceptions.TeacherAlreadyExistsException;
import gr.aueb.cf.schoolapp.model.City;
import gr.aueb.cf.schoolapp.service.CityServiceImpl;
import gr.aueb.cf.schoolapp.service.ICityService;
import gr.aueb.cf.schoolapp.service.ITeacherService;
import gr.aueb.cf.schoolapp.service.TeacherServiceImpl;
import gr.aueb.cf.schoolapp.validator.TeacherValidator;

import javax.swing.*;
import javax.swing.border.EmptyBorder;
import java.awt.*;
import java.awt.event.*;
import java.io.Serial;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;
import java.util.Map;

public class InsertTeacherPage extends JFrame {

	@Serial
	private static final long serialVersionUID = 1L;

	private final JPanel contentPane;
	private final JTextField firstnameText;
	private final JTextField lastnameText;
	private final JTextField vatText;
	private final JTextField fathernameText;
	private final JTextField phoneNumberText;
	private final JTextField emailText;
	private final JTextField streetText;
	private final JTextField streetNumberText;
	private final JTextField zipcodeText;
	private final JLabel errorFirstname;
	private final JLabel errorLastname;
	private final JComboBox&lt;City&gt; cityComboBox;
<span class="nc" id="L47">	private List&lt;City&gt; cities = new ArrayList&lt;&gt;();</span>

<span class="nc" id="L49">	private final ICityDAO cityDao = new CityDAOImpl();</span>
<span class="nc" id="L50">	private final ICityService cityService = new CityServiceImpl(cityDao);</span>

<span class="nc" id="L52">	private final ITeacherDAO teacherDAO = new TeacherDAOImpl();</span>
<span class="nc" id="L53">	private final ITeacherService teacherService = new TeacherServiceImpl(teacherDAO);</span>

<span class="nc" id="L55">	public InsertTeacherPage() {</span>
		
<span class="nc" id="L57">		addWindowListener(new WindowAdapter() {</span>
			@Override
			public void windowActivated(WindowEvent e) {
                try {
                    //cities = cityService.getAllCities();
<span class="nc" id="L62">					cityService.getAllCities().forEach(cityComboBox::addItem);</span>
					//resetInputForm();
<span class="nc" id="L64">                } catch (SQLException ex) {</span>
<span class="nc" id="L65">                    JOptionPane.showMessageDialog(null, &quot;Get cities fatal error.&quot;, &quot;Error&quot;, JOptionPane.ERROR_MESSAGE);</span>
<span class="nc" id="L66">                }</span>

<span class="nc" id="L68">			}</span>
		});
<span class="nc" id="L70">		setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);</span>
<span class="nc" id="L71">		setTitle(&quot;Ποιότητα στην Εκπαίδευση&quot;);</span>
<span class="nc" id="L72">		setBounds(100, 100, 857, 701);</span>
<span class="nc" id="L73">		contentPane = new JPanel();</span>
<span class="nc" id="L74">		contentPane.setBorder(new EmptyBorder(5, 5, 5, 5));</span>

<span class="nc" id="L76">		setContentPane(contentPane);</span>
<span class="nc" id="L77">		contentPane.setLayout(null);</span>
		
<span class="nc" id="L79">		JLabel lblTeacherInfo = new JLabel(&quot;Στοιχεία Εκπαιδευτή&quot;);</span>
<span class="nc" id="L80">		lblTeacherInfo.setFont(new Font(&quot;Tahoma&quot;, Font.BOLD, 22));</span>
<span class="nc" id="L81">		lblTeacherInfo.setBounds(267, 63, 341, 44);</span>
<span class="nc" id="L82">		contentPane.add(lblTeacherInfo);</span>
		
<span class="nc" id="L84">		JPanel header = new JPanel();</span>
<span class="nc" id="L85">		header.setLayout(null);</span>
<span class="nc" id="L86">		header.setBackground(new Color(0, 52, 117));</span>
<span class="nc" id="L87">		header.setBounds(0, 0, 842, 52);</span>
<span class="nc" id="L88">		contentPane.add(header);</span>
		
<span class="nc" id="L90">		JLabel govImage = new JLabel(&quot;&quot;);</span>
<span class="nc" id="L91">		govImage.setIcon(new ImageIcon(InsertTeacherPage.class.getResource(&quot;/images/gov_logo_small.png&quot;)));</span>
<span class="nc" id="L92">		govImage.setBounds(0, 0, 100, 52);</span>
<span class="nc" id="L93">		header.add(govImage);</span>
		
<span class="nc" id="L95">		JLabel firstLastName = new JLabel(&quot;ΑΘΑΝΑΣΙΟΣ ΑΝΔΡΟΥΤΣΟΣ&quot;);</span>
<span class="nc" id="L96">		firstLastName.setForeground(Color.WHITE);</span>
<span class="nc" id="L97">		firstLastName.setBounds(649, 11, 183, 30);</span>
<span class="nc" id="L98">		header.add(firstLastName);</span>
		
<span class="nc" id="L100">		JPanel footer = new JPanel();</span>
<span class="nc" id="L101">		footer.setLayout(null);</span>
<span class="nc" id="L102">		footer.setBounds(0, 574, 842, 90);</span>
<span class="nc" id="L103">		contentPane.add(footer);</span>
		
<span class="nc" id="L105">		JLabel lbl_manual = new JLabel(&quot;Εγχειρίδιο Χρήσης&quot;);</span>
<span class="nc" id="L106">		lbl_manual.setForeground(new Color(0, 52, 117));</span>
<span class="nc" id="L107">		lbl_manual.setBounds(199, 37, 151, 29);</span>
<span class="nc" id="L108">		footer.add(lbl_manual);</span>
		
<span class="nc" id="L110">		JLabel lbl_oftenQuestions = new JLabel(&quot;Συχνές Ερωτήσεις&quot;);</span>
<span class="nc" id="L111">		lbl_oftenQuestions.setForeground(new Color(0, 52, 117));</span>
<span class="nc" id="L112">		lbl_oftenQuestions.setBounds(360, 37, 151, 29);</span>
<span class="nc" id="L113">		footer.add(lbl_oftenQuestions);</span>
		
<span class="nc" id="L115">		JLabel lbl_support = new JLabel(&quot;Υποστήριξη Πολιτών&quot;);</span>
<span class="nc" id="L116">		lbl_support.setForeground(new Color(0, 52, 117));</span>
<span class="nc" id="L117">		lbl_support.setBounds(521, 37, 151, 29);</span>
<span class="nc" id="L118">		footer.add(lbl_support);</span>
		
<span class="nc" id="L120">		JSeparator lineBottom = new JSeparator();</span>
<span class="nc" id="L121">		lineBottom.setBackground(Color.BLUE);</span>
<span class="nc" id="L122">		lineBottom.setBounds(0, 0, 850, 2);</span>
<span class="nc" id="L123">		footer.add(lineBottom);</span>
		
<span class="nc" id="L125">		firstnameText = new JTextField();</span>
<span class="nc" id="L126">		firstnameText.setBounds(91, 131, 263, 37);</span>
<span class="nc" id="L127">		contentPane.add(firstnameText);</span>
<span class="nc" id="L128">		firstnameText.setColumns(10);</span>
		
<span class="nc" id="L130">		firstnameText.addFocusListener(new FocusAdapter() {</span>
			@Override
			public void focusLost(FocusEvent e) {
				String inputFirstname;	
<span class="nc" id="L134">				inputFirstname = firstnameText.getText().trim();</span>
<span class="nc bnc" id="L135" title="All 2 branches missed.">				errorFirstname.setText(inputFirstname.isEmpty() ? &quot;Το όνομα είναι υποχρεωτικό&quot; : &quot;&quot;);</span>
<span class="nc" id="L136">			}</span>
		});
		
<span class="nc" id="L139">		lastnameText = new JTextField();</span>
<span class="nc" id="L140">		lastnameText.setColumns(10);</span>
<span class="nc" id="L141">		lastnameText.setBounds(512, 131, 263, 37);</span>
<span class="nc" id="L142">		contentPane.add(lastnameText);</span>
		
<span class="nc" id="L144">		lastnameText.addFocusListener(new FocusAdapter() {</span>
			@Override
			public void focusLost(FocusEvent e) {
				String inputLastname;	
<span class="nc" id="L148">				inputLastname = lastnameText.getText().trim();</span>
<span class="nc bnc" id="L149" title="All 2 branches missed.">				errorLastname.setText(inputLastname.isEmpty() ? &quot;Το επώνυμο είναι υποχρεωτικό&quot; : &quot;&quot;);</span>
<span class="nc" id="L150">			}</span>
		});
		
<span class="nc" id="L153">		JLabel lblFirstname = new JLabel(&quot;Όνομα*&quot;);</span>
<span class="nc" id="L154">		lblFirstname.setFont(new Font(&quot;Tahoma&quot;, Font.BOLD, 12));</span>
<span class="nc" id="L155">		lblFirstname.setBounds(29, 135, 62, 29);</span>
<span class="nc" id="L156">		contentPane.add(lblFirstname);</span>
		
<span class="nc" id="L158">		JLabel lblLastname = new JLabel(&quot;Επώνυμο*&quot;);</span>
<span class="nc" id="L159">		lblLastname.setFont(new Font(&quot;Tahoma&quot;, Font.BOLD, 12));</span>
<span class="nc" id="L160">		lblLastname.setBounds(432, 135, 84, 29);</span>
<span class="nc" id="L161">		contentPane.add(lblLastname);</span>
		
<span class="nc" id="L163">		JLabel lblVat = new JLabel(&quot;ΑΦΜ*&quot;);</span>
<span class="nc" id="L164">		lblVat.setFont(new Font(&quot;Tahoma&quot;, Font.BOLD, 12));</span>
<span class="nc" id="L165">		lblVat.setBounds(41, 202, 50, 29);</span>
<span class="nc" id="L166">		contentPane.add(lblVat);</span>
		
<span class="nc" id="L168">		vatText = new JTextField();</span>
<span class="nc" id="L169">		vatText.setColumns(10);</span>
<span class="nc" id="L170">		vatText.setBounds(91, 198, 263, 37);</span>
<span class="nc" id="L171">		contentPane.add(vatText);</span>
		
<span class="nc" id="L173">		JLabel lblFathername = new JLabel(&quot;Πατρώνυμο*&quot;);</span>
<span class="nc" id="L174">		lblFathername.setFont(new Font(&quot;Tahoma&quot;, Font.BOLD, 12));</span>
<span class="nc" id="L175">		lblFathername.setBounds(421, 202, 95, 29);</span>
<span class="nc" id="L176">		contentPane.add(lblFathername);</span>
		
<span class="nc" id="L178">		fathernameText = new JTextField();</span>
<span class="nc" id="L179">		fathernameText.setColumns(10);</span>
<span class="nc" id="L180">		fathernameText.setBounds(512, 198, 263, 37);</span>
<span class="nc" id="L181">		contentPane.add(fathernameText);</span>
		
<span class="nc" id="L183">		JLabel lblPhoneNumber = new JLabel(&quot;Τηλέφωνο*&quot;);</span>
<span class="nc" id="L184">		lblPhoneNumber.setFont(new Font(&quot;Tahoma&quot;, Font.BOLD, 12));</span>
<span class="nc" id="L185">		lblPhoneNumber.setBounds(10, 275, 81, 29);</span>
<span class="nc" id="L186">		contentPane.add(lblPhoneNumber);</span>
		
<span class="nc" id="L188">		phoneNumberText = new JTextField();</span>
<span class="nc" id="L189">		phoneNumberText.setColumns(10);</span>
<span class="nc" id="L190">		phoneNumberText.setBounds(91, 271, 263, 37);</span>
<span class="nc" id="L191">		contentPane.add(phoneNumberText);</span>
		
<span class="nc" id="L193">		JLabel lblEmail = new JLabel(&quot;e-mail*&quot;);</span>
<span class="nc" id="L194">		lblEmail.setFont(new Font(&quot;Tahoma&quot;, Font.BOLD, 12));</span>
<span class="nc" id="L195">		lblEmail.setBounds(460, 275, 56, 29);</span>
<span class="nc" id="L196">		contentPane.add(lblEmail);</span>
		
<span class="nc" id="L198">		emailText = new JTextField();</span>
<span class="nc" id="L199">		emailText.setColumns(10);</span>
<span class="nc" id="L200">		emailText.setBounds(512, 271, 263, 37);</span>
<span class="nc" id="L201">		contentPane.add(emailText);</span>
		
<span class="nc" id="L203">		JLabel lblStreet = new JLabel(&quot;Διεύθυνση*&quot;);</span>
<span class="nc" id="L204">		lblStreet.setFont(new Font(&quot;Tahoma&quot;, Font.BOLD, 12));</span>
<span class="nc" id="L205">		lblStreet.setBounds(10, 342, 81, 29);</span>
<span class="nc" id="L206">		contentPane.add(lblStreet);</span>
		
<span class="nc" id="L208">		streetText = new JTextField();</span>
<span class="nc" id="L209">		streetText.setColumns(10);</span>
<span class="nc" id="L210">		streetText.setBounds(91, 338, 263, 37);</span>
<span class="nc" id="L211">		contentPane.add(streetText);</span>
		
<span class="nc" id="L213">		JLabel lblStreetNumber = new JLabel(&quot;Αριθμός*&quot;);</span>
<span class="nc" id="L214">		lblStreetNumber.setFont(new Font(&quot;Tahoma&quot;, Font.BOLD, 12));</span>
<span class="nc" id="L215">		lblStreetNumber.setBounds(446, 342, 70, 29);</span>
<span class="nc" id="L216">		contentPane.add(lblStreetNumber);</span>
		
<span class="nc" id="L218">		streetNumberText = new JTextField();</span>
<span class="nc" id="L219">		streetNumberText.setColumns(10);</span>
<span class="nc" id="L220">		streetNumberText.setBounds(512, 338, 263, 37);</span>
<span class="nc" id="L221">		contentPane.add(streetNumberText);</span>
		
<span class="nc" id="L223">		JLabel lblCity = new JLabel(&quot;Πόλη*&quot;);</span>
<span class="nc" id="L224">		lblCity.setFont(new Font(&quot;Tahoma&quot;, Font.BOLD, 12));</span>
<span class="nc" id="L225">		lblCity.setBounds(41, 411, 50, 29);</span>
<span class="nc" id="L226">		contentPane.add(lblCity);</span>
		
<span class="nc" id="L228">		JLabel lblZipCode = new JLabel(&quot;ΤΚ*&quot;);</span>
<span class="nc" id="L229">		lblZipCode.setFont(new Font(&quot;Tahoma&quot;, Font.BOLD, 12));</span>
<span class="nc" id="L230">		lblZipCode.setBounds(481, 411, 35, 29);</span>
<span class="nc" id="L231">		contentPane.add(lblZipCode);</span>
		
<span class="nc" id="L233">		zipcodeText = new JTextField();</span>
<span class="nc" id="L234">		zipcodeText.setColumns(10);</span>
<span class="nc" id="L235">		zipcodeText.setBounds(512, 407, 263, 37);</span>
<span class="nc" id="L236">		contentPane.add(zipcodeText);</span>
		
<span class="nc" id="L238">		errorFirstname = new JLabel(&quot;&quot;);</span>
<span class="nc" id="L239">		errorFirstname.setForeground(new Color(255, 0, 0));</span>
<span class="nc" id="L240">		errorFirstname.setBounds(92, 167, 260, 29);</span>
<span class="nc" id="L241">		contentPane.add(errorFirstname);</span>
		
<span class="nc" id="L243">		errorLastname = new JLabel(&quot;&quot;);</span>
<span class="nc" id="L244">		errorLastname.setForeground(new Color(255, 0, 0));</span>
<span class="nc" id="L245">		errorLastname.setBounds(514, 167, 260, 29);</span>
<span class="nc" id="L246">		contentPane.add(errorLastname);</span>
		
<span class="nc" id="L248">		cityComboBox = new JComboBox&lt;&gt;();</span>
<span class="nc" id="L249">		cityComboBox.setBounds(89, 407, 263, 37);</span>
<span class="nc" id="L250">		contentPane.add(cityComboBox);</span>

<span class="nc" id="L252">		JButton insertBtn = new JButton(&quot;Υποβολή&quot;);</span>
<span class="nc" id="L253">		insertBtn.addActionListener(new ActionListener() {</span>
			public void actionPerformed(ActionEvent e) {
				TeacherReadOnlyDTO teacherReadOnlyDTO;
<span class="nc" id="L256">				TeacherInsertDTO insertDTO = doDataBinding(); // Data binding</span>

				// Validation
<span class="nc" id="L259">				Map&lt;String , String&gt; errors = TeacherValidator.validate(insertDTO); 	// Validation</span>
<span class="nc bnc" id="L260" title="All 2 branches missed.">				if (!errors.isEmpty()) {</span>
<span class="nc" id="L261">					errorFirstname.setText(errors.getOrDefault(&quot;firstname&quot;, &quot;&quot;));</span>
<span class="nc" id="L262">					errorLastname.setText(errors.getOrDefault(&quot;lastname&quot;, &quot;&quot;));</span>
<span class="nc" id="L263">					return;</span>
				}
                try {
<span class="nc" id="L266">                    teacherReadOnlyDTO = teacherService.insertTeacher(insertDTO);</span>
<span class="nc" id="L267">					Main.getInsertSuccessPage().setUuidText(teacherReadOnlyDTO.getUuid());</span>
<span class="nc" id="L268">					Main.getInsertTeacherPage().setEnabled(false);</span>
<span class="nc" id="L269">					Main.getInsertSuccessPage().setVisible(true);</span>
<span class="nc" id="L270">					resetInputForm();</span>
<span class="nc" id="L271">				} catch (TeacherDAOException ex) {</span>
<span class="nc" id="L272">					JOptionPane.showMessageDialog(null, &quot;DB Error&quot;, &quot;Error&quot;, JOptionPane.ERROR_MESSAGE);</span>
<span class="nc" id="L273">                } catch (TeacherAlreadyExistsException ex) {</span>
<span class="nc" id="L274">					JOptionPane.showMessageDialog(null, &quot;Teacher already exists&quot;, &quot;Error&quot;, JOptionPane.ERROR_MESSAGE);</span>
<span class="nc" id="L275">                }</span>
<span class="nc" id="L276">			}</span>
		});

<span class="nc" id="L279">		insertBtn.setFont(new Font(&quot;Tahoma&quot;, Font.PLAIN, 12));</span>
<span class="nc" id="L280">		insertBtn.setForeground(new Color(255, 255, 255));</span>
<span class="nc" id="L281">		insertBtn.setBackground(new Color(64, 128, 128));</span>
<span class="nc" id="L282">		insertBtn.setBounds(512, 485, 263, 54);</span>
<span class="nc" id="L283">		contentPane.add(insertBtn);</span>
		
<span class="nc" id="L285">		JButton closeBtn = new JButton(&quot;Κλείσιμο&quot;);</span>
<span class="nc" id="L286">		closeBtn.addActionListener(new ActionListener() {</span>
			public void actionPerformed(ActionEvent e) {
<span class="nc" id="L288">				Main.getDashboard().setEnabled(true);</span>
<span class="nc" id="L289">				Main.getInsertTeacherPage().setVisible(false);</span>
<span class="nc" id="L290">			}</span>
		});
<span class="nc" id="L292">		closeBtn.setForeground(new Color(0, 0, 0));</span>
<span class="nc" id="L293">		closeBtn.setFont(new Font(&quot;Tahoma&quot;, Font.PLAIN, 12));</span>
<span class="nc" id="L294">		closeBtn.setBackground(new Color(192, 192, 192));</span>
<span class="nc" id="L295">		closeBtn.setBounds(91, 485, 263, 54);</span>
<span class="nc" id="L296">		contentPane.add(closeBtn);	</span>
<span class="nc" id="L297">	}</span>

	private TeacherInsertDTO doDataBinding() {
<span class="nc" id="L300">		final int DEFAULT_CITY_ID = 1;</span>
<span class="nc" id="L301">		String firstname = firstnameText.getText().trim();</span>
<span class="nc" id="L302">		String lastname = lastnameText.getText().trim();</span>
<span class="nc" id="L303">		String vat = vatText.getText().trim();</span>
<span class="nc" id="L304">		String fathername = fathernameText.getText().trim();</span>
<span class="nc" id="L305">		String phoneNumber = phoneNumberText.getText().trim();</span>
<span class="nc" id="L306">		String email = emailText.getText().trim();</span>
<span class="nc" id="L307">		String street = streetText.getText().trim();</span>
<span class="nc" id="L308">		String streetNumber = streetNumberText.getText().trim();</span>
<span class="nc" id="L309">		City selectedCity = (City) cityComboBox.getSelectedItem();</span>
<span class="nc bnc" id="L310" title="All 2 branches missed.">		int cityId = (selectedCity != null) ? selectedCity.getId() : DEFAULT_CITY_ID;</span>
<span class="nc" id="L311">		String zipcode = zipcodeText.getText().trim();</span>

<span class="nc" id="L313">		return new TeacherInsertDTO(firstname, lastname, vat, fathername,</span>
<span class="nc" id="L314">				phoneNumber, email, street, streetNumber, zipcode, cityId);</span>
	}

	private void resetInputForm() {
<span class="nc" id="L318">		firstnameText.setText(&quot;&quot;);</span>
<span class="nc" id="L319">		lastnameText.setText(&quot;&quot;);</span>
<span class="nc" id="L320">		vatText.setText(&quot;&quot;);</span>
<span class="nc" id="L321">		fathernameText.setText(&quot;&quot;);</span>
<span class="nc" id="L322">		phoneNumberText.setText(&quot;&quot;);</span>
<span class="nc" id="L323">		emailText.setText(&quot;&quot;);</span>
<span class="nc" id="L324">		streetText.setText(&quot;&quot;);</span>
<span class="nc" id="L325">		streetNumberText.setText(&quot;&quot;);</span>
<span class="nc" id="L326">		cityComboBox.setSelectedIndex(0);</span>
<span class="nc" id="L327">		zipcodeText.setText(&quot;&quot;);</span>
<span class="nc" id="L328">		errorFirstname.setText(&quot;&quot;);</span>
<span class="nc" id="L329">		errorLastname.setText(&quot;&quot;);</span>
<span class="nc" id="L330">	}</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>